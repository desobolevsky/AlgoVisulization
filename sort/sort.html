<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sorting</title>

    <script src="../node_modules/jquery/dist/jquery.min.js"></script>
    <script src="../node_modules/chart.js/dist/chart.js"></script>

    <script src="../utils.js"></script>
    <script src="sortings.js"></script>
</head>
<body>
<div class="slidecontainer">
    <label>Time Delta</label>
    <input type="range" min="1" max="500" value="50" id="sleepTimeRange" autocomplete="off" onchange="updateTime(this.value)">
</div>
<div class="slidecontainer">
    <label>Numbers amount</label>
    <input type="range" min="2" max="50" value="20" id="elementsNumberRange" autocomplete="off">
</div>
<button id="startButton" onclick="clickHandler()">Sort</button>
<canvas id="main_chart"></canvas>
<script>
    const canvas = document.getElementById('main_chart').getContext('2d');
    const elementsNumberSlider = document.getElementById('elementsNumberRange');
    const timeDeltaSlider = document.getElementById('sleepTimeRange');
    const startButton = document.getElementById('startButton');
    const defaultColor = 'rgb(135,135,135)';
    const iteratedColor = 'rgb(255, 0, 0)';
    let currentArrayLength = 20;
    let currentSleepTime = 50;
    let numbersArray = generateRandomArray(currentArrayLength);

    elementsNumberSlider.addEventListener("click", function () {
        currentArrayLength = parseInt(this.value);
        numbersArray = generateRandomArray(currentArrayLength);
        chart.data.datasets[0].data = numbersArray;
        chart.data.datasets[0].backgroundColor = Array.from({length: currentArrayLength}, () => defaultColor);
        chart.data.labels = numbersArray;
        chart.update();
    })

    timeDeltaSlider.addEventListener("click", function () {
        currentSleepTime = this.value;
    })

    startButton.addEventListener("click", function () {
        numbersArray = bubbleSort(numbersArray, chart.data.datasets[0].backgroundColor);
        chart.update()
    })

    let chart = new Chart(canvas, {
        type: 'bar',
        data: {
            labels: numbersArray,
            datasets: [{
                data: numbersArray,
                backgroundColor: Array.from({length: currentArrayLength}, () => defaultColor)
            }]
        },
        options: {
            animation: false,
        }
    });

    function switchInterfaceState(isEnabled){
        elementsNumberSlider.disabled = !isEnabled;
        startButton.disabled = !isEnabled;
    }

    function generateRandomArray(arrayLength){
        return Array.from({length: arrayLength}, () => Math.floor(Math.random() * 50) + 1);
    }
</script>

</body>
</html>